<div class="row book">
  <div class="panel panel-default">
    <div class="panel-body">
      <div class="col-md-3">
        <%= image_tag(user_book.photo, class: "img-responsive", alt: "Responsive image") %>
      </div>
      <div class="col-md-6">
        <h4> <%= user_book.title %> </h4> <br>
        <%= user_book.authors.map(&:name).join(', ') %> <br>
        <% if (@comment = user_book.most_recent_comment(current_user)).present? %>
          <%= @comment.content %> says <%= @comment.user.username %>
        <% end %>
      </div>
      <div class="col-md-3">
      <% if user_signed_in? && current_user.does_not_have(user_book) %>
        <%= button_to "Add to MyReads", listed_books_path(asin: user_book.asin), class: "btn btn-default" %>
      <% elsif user_signed_in? %>
        <div class="dropdown">
          <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
            Recommend to:
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">

            <% user.mutual_follows.each do |followee| %>
              <li role="presentation"><%= link_to(followee.username, recommendations_path(recipient: followee, book: user_book), method: :post, role: 'menuitem', tabindex: '-1') unless current_user.has_recommended?(user_book, followee) %> </li>
            <% end %>
          </ul>
        </div>
      <% else %>
        <%= button_to "Add to MyReads", new_user_session_path, method: :get, class: "btn btn-default" %>
      <% end %>
      </div>
    </div>
  </div>
</div>
